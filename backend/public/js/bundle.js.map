{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./frontend/UI.js","webpack:///./frontend/app.js","webpack:///./frontend/services/BookService.js","webpack:///./frontend/styles/app.css","webpack:///./node_modules/timeago.js/esm/format.js","webpack:///./node_modules/timeago.js/esm/index.js","webpack:///./node_modules/timeago.js/esm/lang/en_US.js","webpack:///./node_modules/timeago.js/esm/lang/zh_CN.js","webpack:///./node_modules/timeago.js/esm/locales.js","webpack:///./node_modules/timeago.js/esm/realtime.js","webpack:///./node_modules/timeago.js/esm/utils/date.js","webpack:///./node_modules/timeago.js/esm/utils/dom.js"],"names":[],"mappings":";QAAA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;;QAGA;QACA;;;;;;;;;;;;;AClFA;AAAA;AAAA;AAAiD;AACb;AACpC,wBAAwB,6DAAW;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yDAAyD,eAAe;AACxE;AACA;AACA;AACA,qDAAqD,WAAW;AAChE,mDAAmD,YAAY;AAC/D,4EAA4E,SAAS;AACrF;AACA;AACA;AACA;AACA,sBAAsB,yDAAM;AAC5B;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,K;AACA,8B;AACA;AACA;AACA;AACA,0D;AACA;AACA,qCAAqC,aAAa;AAClD;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACe,iEAAE,E;;;;;;;;;;;;AC1DjB;AAAA;AAAA;AAAA;AAA0B;AACJ;;AAEtB;AACA,iBAAiB,2CAAE;AACnB;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,2CAAE;AACnB,4B;AACA;AACA;AACA,CAAC;AACD;AACA;AACA,mBAAmB,2CAAE,G;AACrB;AACA;AACA,M;AACA;AACA,CAAC,C;;;;;;;;;;;;ACjCD;AAAA;AACA;AACA,mD;AACA;AACA;AACA;AACA;AACA;AACA,K;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,uBAAuB,SAAS,GAAG,OAAO;AAC1C,iCAAiC,SAAS,GAAG,OAAO;AACpD;AACA;AACA,aAAa;AACb;AACA,SAAS;AACT;AACA;AACA;AACA;AACe,0EAAW,E;;;;;;;;;;;AC7B1B,uC;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAmD;AACb;AACtC;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA,cAAc,2DAAO;AACrB;AACA,WAAW,8DAAU,MAAM,0DAAS;AACpC;AACA,kC;;;;;;;;;;;;ACdA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACkC;AACU;AACP;AACrC,iC;;;;;;;;;;;;ACPA;AAAA;AACe;AACf;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,iC;;;;;;;;;;;;ACTA;AAAA;AACe;AACf;AACA;AACA;AACA;AACA,CAAC;AACD,iC;;;;;;;;;;;;ACPA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACiC;AACA;AACjC;AACA;AACA,WAAW;AACX;AACA;AACA,WAAW,mDAAK;AAChB,WAAW,mDAAK;AAChB;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACO;AACP,8BAA8B,mDAAK;AACnC;AACA,mC;;;;;;;;;;;;AC9BA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAuE;AACN;AAC3B;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,6DAAU;AACpB;AACA;AACA,eAAe,2DAAO;AACtB;AACA,qBAAqB,8DAAU;AAC/B;AACA;AACA,KAAK,oBAAoB,gEAAY;AACrC;AACA;AACA,IAAI,6DAAU;AACd;AACA;AACO;AACP;AACA;AACA,cAAc,6DAAU;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA,kBAAkB,mEAAgB,QAAQ,0DAAS,oBAAoB;AACvE,KAAK;AACL;AACA;AACA,oC;;;;;;;;;;;;ACtDA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA,UAAU,kDAAkD;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA,UAAU,8CAA8C;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gC;;;;;;;;;;;;ACjFA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa;AACb;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA,+B","file":"js/bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./frontend/app.js\");\n","import BookService from './services/BookService';\r\nimport { format } from 'timeago.js';\r\nconst bookService = new BookService();\r\nclass UI {\r\n    async renderBooks() {\r\n        const books = await bookService.getBooks();\r\n        const booksCardContainer = document.getElementById('books-cards');\r\n        booksCardContainer.innerHTML = '';\r\n        books.forEach(book => {\r\n            const div = document.createElement('div');\r\n            div.className = '';\r\n            div.innerHTML = `\r\n            <div class=\"card m-2\">\r\n                <div class=\"row\">\r\n                    <div class=\"col-md-4\">\r\n                        <img src=\"http://localhost:4000${book.imagePath}\" alt=\"\" class=\"img-fluid\"/>            \r\n                    </div>\r\n                    <div class=\"col-md-8\">\r\n                        <div class=\"card-block px-2\">\r\n                            <h4 class=\"card-title\">${book.title}</h4>\r\n                            <p class=\"card-text\">${book.author}</p>\r\n                            <a href=\"#\"class =\"btn btn-danger delete\"_id=\"${book._id}\">X</a>\r\n                        </div>\r\n                     </div>\r\n                 </div>\r\n                <div class=\"card-footer\">\r\n                    ${format(book.creat_at)}\r\n                </div>\r\n            </div>   \r\n            `;\r\n            booksCardContainer.appendChild(div);\r\n        });\r\n    }\r\n\r\n    async addNewBook(book) {\r\n        await bookService.postBook(book);\r\n        this.clearBookForm();\r\n        this.renderBooks();\r\n    }\r\n    clearBookForm() {\r\n        document.getElementById('book-form').reset();\r\n    }    \r\n    async deleteBook(bookId) {       \r\n        await bookService.deleteBook(bookId);\r\n        this.renderBooks();\r\n     }\r\n     renderMessage(message,colorMessage,secondsToRemove) { \r\n        const div=document.createElement('div');\r\n        div.className=`alert alert-${colorMessage} message`;\r\n        div.appendChild(document.createTextNode(message));\r\n        const container=document.querySelector('.col-md-4');\r\n        const bookForm=document.querySelector('#book-form');\r\n        container.insertBefore(div,bookForm);\r\n        setTimeout(()=>{\r\n            document.querySelector('.message').remove();\r\n        },secondsToRemove);\r\n     }\r\n}\r\nexport default UI;","import './styles/app.css';\r\nimport UI from './UI';\r\n\r\ndocument.addEventListener('DOMContentLoaded',()=>{\r\n    const ui=new UI();\r\n    ui.renderBooks();\r\n})\r\n\r\ndocument.getElementById('book-form')\r\n.addEventListener('submit',e=>{\r\n    const title=document.getElementById('title').value;\r\n    const author=document.getElementById('author').value;\r\n    const isbn=document.getElementById('isbn').value;\r\n    const image=document.getElementById('image').files;\r\n\r\n    console.log(title,author,isbn,image);\r\n    const formData=new FormData();\r\n    formData.append('image',image[0]);\r\n    formData.append('title',title);\r\n    formData.append('author',author);\r\n    formData.append('isbn',isbn);\r\n    const ui=new UI();\r\n    ui.addNewBook(formData);    \r\n    ui.renderMessage('new Book Added','success',2000);\r\n    e.preventDefault()\r\n})\r\ndocument.getElementById('books-cards').addEventListener('click',e=>{\r\n  if (e.target.classList.contains('delete')) {\r\n      const ui=new UI();      \r\n      ui.deleteBook(e.target.getAttribute('_id'));\r\n      ui.renderMessage('Book romeved','danger',2000);\r\n     }  \r\n  e.preventDefault();\r\n})","class BookService{\r\n    constructor(){\r\n        this.URI='http://localhost:4000/api/books';        \r\n    }\r\n    async getBooks(){\r\n        const response=await fetch(this.URI);\r\n        const books=response.json();\r\n        return books;\r\n    }   \r\n    async postBook (book){\r\n        const res=await fetch(this.URI,{\r\n            method:'POST',\r\n            body:book\r\n        });\r\n        const data=await res.json();\r\n        console.log(data);\r\n    }\r\n    async deleteBook(bookid){\r\n        console.log(`${this.URI}/${bookid}`);\r\n        const res=await fetch(`${this.URI}/${bookid}`,{\r\n            headers:{\r\n                'Content-Type':'application/json'\r\n            },\r\n            method:'DELETE'\r\n        });\r\n        const data=await res.json();\r\n        console.log(data)\r\n    }\r\n}\r\nexport default BookService;","// extracted by mini-css-extract-plugin","import { formatDiff, diffSec } from './utils/date';\r\nimport { getLocale } from './locales';\r\n/**\r\n * format a TDate into string\r\n * @param date\r\n * @param locale\r\n * @param opts\r\n */\r\nexport var format = function (date, locale, opts) {\r\n    // diff seconds\r\n    var sec = diffSec(date, opts && opts.relativeDate);\r\n    // format it with locale\r\n    return formatDiff(sec, getLocale(locale));\r\n};\r\n//# sourceMappingURL=format.js.map","/**\r\n * Created by hustcc on 18/5/20.\r\n * Contract: i@hust.cc\r\n */\r\nexport { format } from './format';\r\nexport { render, cancel } from './realtime';\r\nexport { register } from './locales';\r\n//# sourceMappingURL=index.js.map","var EN_US = ['second', 'minute', 'hour', 'day', 'week', 'month', 'year'];\r\nexport default function (diff, idx) {\r\n    if (idx === 0)\r\n        return ['just now', 'right now'];\r\n    var unit = EN_US[~~(idx / 2)];\r\n    if (diff > 1)\r\n        unit += 's';\r\n    return [diff + \" \" + unit + \" ago\", \"in \" + diff + \" \" + unit];\r\n}\r\n//# sourceMappingURL=en_US.js.map","var ZH_CN = ['秒', '分钟', '小时', '天', '周', '个月', '年'];\r\nexport default function (diff, idx) {\r\n    if (idx === 0)\r\n        return ['刚刚', '片刻后'];\r\n    var unit = ZH_CN[~~(idx / 2)];\r\n    return [diff + \" \" + unit + \"\\u524D\", diff + \" \" + unit + \"\\u540E\"];\r\n}\r\n//# sourceMappingURL=zh_CN.js.map","/**\r\n * Created by hustcc on 18/5/20.\r\n * Contract: i@hust.cc\r\n */\r\nimport en_US from './lang/en_US';\r\nimport zh_CN from './lang/zh_CN';\r\n/**\r\n * All locales supported. en_US, zh_CN is build-in\r\n * @type {{en: function(*, *), zh_CN: function(*, *)}}\r\n */\r\nvar Locales = {\r\n    en_US: en_US,\r\n    zh_CN: zh_CN,\r\n};\r\n/**\r\n * register a locale\r\n * @param locale\r\n * @param func\r\n */\r\nexport var register = function (locale, func) {\r\n    Locales[locale] = func;\r\n};\r\n/**\r\n * get a locale, default is en_US\r\n * @param locale\r\n * @returns {*}\r\n */\r\nexport var getLocale = function (locale) {\r\n    return Locales[locale] || en_US;\r\n};\r\n//# sourceMappingURL=locales.js.map","import { setTimerId, getTimerId, getDateAttribute } from './utils/dom';\r\nimport { formatDiff, diffSec, nextInterval } from './utils/date';\r\nimport { getLocale } from './locales';\r\n// all realtime timer\r\nvar TIMER_POOL = {};\r\n/**\r\n * clear a timer from pool\r\n * @param tid\r\n */\r\nvar clear = function (tid) {\r\n    clearTimeout(tid);\r\n    delete TIMER_POOL[tid];\r\n};\r\n// run with timer(setTimeout)\r\nfunction run(node, date, localeFunc, opts) {\r\n    // clear the node's exist timer\r\n    clear(getTimerId(node));\r\n    var relativeDate = opts.relativeDate, minInterval = opts.minInterval;\r\n    // get diff seconds\r\n    var diff = diffSec(date, relativeDate);\r\n    // render\r\n    node.innerText = formatDiff(diff, localeFunc);\r\n    var tid = setTimeout(function () {\r\n        run(node, date, localeFunc, opts);\r\n    }, Math.min(Math.max(nextInterval(diff), minInterval || 1) * 1000, 0x7fffffff));\r\n    // there is no need to save node in object. Just save the key\r\n    TIMER_POOL[tid] = 0;\r\n    setTimerId(node, tid);\r\n}\r\n// 取消一个 node 的实时渲染\r\nexport function cancel(node) {\r\n    // cancel one\r\n    if (node)\r\n        clear(getTimerId(node));\r\n    // cancel all\r\n    // @ts-ignore\r\n    else\r\n        Object.keys(TIMER_POOL).forEach(clear);\r\n}\r\n/**\r\n * render a dom realtime\r\n * @param nodes\r\n * @param locale\r\n * @param opts\r\n */\r\nexport function render(nodes, locale, opts) {\r\n    // by .length\r\n    // @ts-ignore\r\n    var nodeList = nodes.length ? nodes : [nodes];\r\n    nodeList.forEach(function (node) {\r\n        run(node, getDateAttribute(node), getLocale(locale), opts || {});\r\n    });\r\n    return nodeList;\r\n}\r\n//# sourceMappingURL=realtime.js.map","/**\r\n * Created by hustcc on 18/5/20.\r\n * Contract: i@hust.cc\r\n */\r\nvar SEC_ARRAY = [60, 60, 24, 7, 365 / 7 / 12, 12];\r\n/**\r\n * format Date / string / timestamp to timestamp\r\n * @param input\r\n * @returns {*}\r\n */\r\nexport function toDate(input) {\r\n    if (input instanceof Date)\r\n        return input;\r\n    // @ts-ignore\r\n    if (!isNaN(input) || /^\\d+$/.test(input))\r\n        return new Date(parseInt(input));\r\n    input = (input || '')\r\n        // @ts-ignore\r\n        .trim()\r\n        .replace(/\\.\\d+/, '') // remove milliseconds\r\n        .replace(/-/, '/')\r\n        .replace(/-/, '/')\r\n        .replace(/(\\d)T(\\d)/, '$1 $2')\r\n        .replace(/Z/, ' UTC') // 2017-2-5T3:57:52Z -> 2017-2-5 3:57:52UTC\r\n        .replace(/([+-]\\d\\d):?(\\d\\d)/, ' $1$2'); // -04:00 -> -0400\r\n    return new Date(input);\r\n}\r\n/**\r\n * format the diff second to *** time ago, with setting locale\r\n * @param diff\r\n * @param localeFunc\r\n * @returns\r\n */\r\nexport function formatDiff(diff, localeFunc) {\r\n    // if locale is not exist, use defaultLocale.\r\n    // if defaultLocale is not exist, use build-in `en`.\r\n    // be sure of no error when locale is not exist.\r\n    var agoIn = diff < 0 ? 1 : 0; // time in or time ago\r\n    diff = Math.abs(diff);\r\n    var totalSec = diff;\r\n    var idx = 0;\r\n    for (; diff >= SEC_ARRAY[idx] && idx < SEC_ARRAY.length; idx++) {\r\n        diff /= SEC_ARRAY[idx];\r\n    }\r\n    // Math.floor\r\n    diff = ~~diff;\r\n    idx *= 2;\r\n    if (diff > (idx === 0 ? 9 : 1))\r\n        idx += 1;\r\n    // @ts-ignore\r\n    return localeFunc(diff, idx, totalSec)[agoIn].replace('%s', diff);\r\n}\r\n/**\r\n * calculate the diff second between date to be formatted an now date.\r\n * @param date\r\n * @param relativeDate\r\n * @returns\r\n */\r\nexport function diffSec(date, relativeDate) {\r\n    relativeDate = relativeDate ? toDate(relativeDate) : new Date();\r\n    return (+relativeDate - +toDate(date)) / 1000;\r\n}\r\n/**\r\n * nextInterval: calculate the next interval time.\r\n * - diff: the diff sec between now and date to be formatted.\r\n *\r\n * What's the meaning?\r\n * diff = 61 then return 59\r\n * diff = 3601 (an hour + 1 second), then return 3599\r\n * make the interval with high performance.\r\n **/\r\nexport function nextInterval(diff) {\r\n    var rst = 1, i = 0, d = Math.abs(diff);\r\n    for (; diff >= SEC_ARRAY[i] && i < SEC_ARRAY.length; i++) {\r\n        diff /= SEC_ARRAY[i];\r\n        rst *= SEC_ARRAY[i];\r\n    }\r\n    d = d % rst;\r\n    d = d ? rst - d : rst;\r\n    return Math.ceil(d);\r\n}\r\n//# sourceMappingURL=date.js.map","var ATTR_TIMEAGO_TID = 'timeago-id';\r\n/**\r\n * get the datetime attribute, `datetime` are supported.\r\n * @param node\r\n * @returns {*}\r\n */\r\nexport function getDateAttribute(node) {\r\n    return node.getAttribute('datetime');\r\n}\r\n/**\r\n * set the node attribute, native DOM\r\n * @param node\r\n * @param timerId\r\n * @returns {*}\r\n */\r\nexport function setTimerId(node, timerId) {\r\n    // @ts-ignore\r\n    node.setAttribute(ATTR_TIMEAGO_TID, timerId);\r\n}\r\n/**\r\n * get the timer id\r\n * @param node\r\n */\r\nexport function getTimerId(node) {\r\n    return parseInt(node.getAttribute(ATTR_TIMEAGO_TID));\r\n}\r\n//# sourceMappingURL=dom.js.map"],"sourceRoot":""}